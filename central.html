<!DOCTYPE html>
<html>
<head>
  <title>Central Authorities - India Power Governance Monitor</title>
  <style>
    body {
      font-family: Arial, sans-serif;
    }

    table {
      border-collapse: collapse;
      width: 100%;
    }

    th, td {
      border: 1px solid #ccc;
      padding: 8px;
      text-align: left;
    }

    th {
      background-color: #f2f2f2;
    }

    select {
      padding: 6px;
      margin-bottom: 10px;
      margin-right: 10px;
    }
  </style>
</head>

<body>
  <h1>Central Authorities</h1>

  <label><strong>Filter by Authority:</strong></label>
  <select id="authorityFilter">
    <option value="All">All</option>
  </select>

  <label><strong>Filter by Category:</strong></label>
  <select id="categoryFilter">
    <option value="All">All</option>
  </select>

  <br><br>

  <table id="central-table">
    <tr>
      <th>Date</th>
      <th>Authority</th>
      <th>Category</th>
      <th>Doc Type</th>
      <th>Title</th>
      <th>Link</th>
    </tr>
  </table>

  <script>
    fetch("data/central.json")
      .then(response => response.json())
      .then(data => {

        const table = document.getElementById("central-table");
        const authorityFilter = document.getElementById("authorityFilter");
        const categoryFilter = document.getElementById("categoryFilter");

        // Populate filters
        const authorities = [...new Set(data.map(item => item.authority))];
        const categories = [...new Set(data.map(item => item.category))];

        authorities.forEach(auth => {
          const option = document.createElement("option");
          option.value = auth;
          option.text = auth;
          authorityFilter.appendChild(option);
        });

        categories.forEach(cat => {
          const option = document.createElement("option");
          option.value = cat;
          option.text = cat;
          categoryFilter.appendChild(option);
        });

        function renderTable(selectedAuthority, selectedCategory) {

          while (table.rows.length > 1) {
            table.deleteRow(1);
          }

          data.sort((a, b) => new Date(b.date) - new Date(a.date));

          data.forEach(item => {
            if (
              (selectedAuthority === "All" || item.authority === selectedAuthority) &&
              (selectedCategory === "All" || item.category === selectedCategory)
            ) {

              const row = table.insertRow();

              row.insertCell(0).innerText = item.date;
              row.insertCell(1).innerText = item.authority;
              row.insertCell(2).innerText = item.category;
              row.insertCell(3).innerText = item.doc_type;
              row.insertCell(4).innerText = item.title;

              const linkCell = row.insertCell(5);
              const link = document.createElement("a");
              link.href = item.link;
              link.target = "_blank";
              link.innerText = "View";
              linkCell.appendChild(link);
            }
          });
        }

        authorityFilter.addEventListener("change", () => {
          renderTable(authorityFilter.value, categoryFilter.value);
        });

        categoryFilter.addEventListener("change", () => {
          renderTable(authorityFilter.value, categoryFilter.value);
        });

        renderTable("All", "All");

      })
      .catch(error => {
        console.error("Error loading data:", error);
      });
  </script>

  <br>
  <a href="index.html">Back to Home</a>

</body>
</html>
